-- Рассчитываем рентабельность расходов (profitability) с использованием NULLIF()
-- NULLIF(expenses, 0) возвращает NULL, если expenses равно 0, предотвращая деление на ноль

SELECT
    ROUND(revenue::NUMERIC / NULLIF(expenses, 0), 2) AS profitability
FROM
    sales;